---
title: "Airbnb Pricing Analysis in Europe"
author: "Yacine Montacer"
date: "08/05/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

For my end of studies mini-senior project, I found a dataset containing Airbnb rental data for European cities for over 51,000 listings. The dataset includes features such as the total listing price, room type, host status, amenities and location information which can be exploited to analyze these factors' relation to the Airbnb prices. For more information see: <https://www.kaggle.com/datasets/thedevastator/airbnb-price-determinants-in-europe?resource=download>

Let's start by importing our dataset:

```{r importation}
file_path <- "data/amsterdam_weekdays.csv"
amsterdam_weekday_data <- read.csv(file_path, header = TRUE, sep = ",", stringsAsFactors = FALSE)

#display first lines of data 
head(amsterdam_weekday_data, 5)
```

Now let's include the libraries we need to move forward: 

```{r libraries}
library(ggplot2)
library(dplyr)
library(tidyr)
```

Now let's proceed with exploratory data analysis: 

```{r exploratory analysis}
# Summary statistics
summary(amsterdam_weekday_data)

# Histogram of price
ggplot(amsterdam_weekday_data, aes(x = realSum)) +
  geom_histogram(fill = "steelblue", bins = 30) +
  labs(x = "Price", y = "Frequency", title = "Distribution of Prices")

# Boxplot of price by room type
ggplot(amsterdam_weekday_data, aes(x = room_type, y = realSum)) +
  geom_boxplot(fill = "steelblue") +
  labs(x = "Room Type", y = "Price", title = "Price Variation by Room Type")

# Scatterplot of price vs. distance to metro
ggplot(amsterdam_weekday_data, aes(x = metro_dist, y = realSum)) +
  geom_point(color = "steelblue") +
  labs(x = "Distance to Metro", y = "Price", title = "Price vs. Distance to Metro")
```

let's import additional libraries and proceed with a correlation matrix:

```{r correlation matrix}
# Load the necessary libraries
library(dplyr)
library(readr)
library(corrplot)

# Correlation matrix
cor_matrix <- cor(amsterdam_weekday_data[, c("realSum", "person_capacity", "cleanliness_rating", "guest_satisfaction_overall", "bedrooms", "dist", "metro_dist", "rest_index", "attr_index", "rest_index_norm", "attr_index_norm", "lng", "lat", "biz")])
cor_matrix

# Visualize the correlation matrix
corrplot(cor_matrix, method = "color", type = "upper", order = "hclust")
```
Seeing the variables that correlate with the price, we can try to create a linear regression model: 

```{r lm}
library(tidyverse)
library(caret)

#model
lm_model <- lm(realSum ~ person_capacity + bedrooms + attr_index_norm + rest_index_norm + guest_satisfaction_overall + dist + metro_dist, data = amsterdam_weekday_data)

#summarize LM model
summary(lm_model)

# Test the model on new data
new_data <- data.frame(person_capacity = 4, bedrooms = 2, attr_index_norm = 0.8, rest_index_norm = 0.6, guest_satisfaction_overall = 4.5, dist = 10, metro_dist = 5)
predicted_realSum <- predict(lm_model, newdata = new_data)

# Print the predicted realSum
print(predicted_realSum)
```

